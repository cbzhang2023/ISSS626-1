---
title: "Take-home Exercise 1"
author: "Zhang Chenbin"
date: "`r s.Date()"
date-modified: "last-modified"
execute: 
  eval: true
  echo: true
  message: false
  freeze: true
format: 
  html:
    code-fold: true
---

```{r}
pacman::p_load(sf, spNetwork, tmap, tidyverse)
```

```{r}
car_acc <- read.csv('data/thai_road_accident_2019_2022.csv') %>%
  # Remove rows with missing longitude or latitude
  filter(!is.na(longitude) & !is.na(latitude)) %>%
  
  # Create new columns for month and day of the week
  mutate(Month_num = month(incident_datetime)) %>%
  mutate(Month_fac = month(incident_datetime, label = TRUE, abbr = TRUE)) %>%
  mutate(dayofweek = day(incident_datetime)) %>%
  
  # Convert the data frame to a spatial sf object
  st_as_sf(coords = c("longitude", "latitude"), crs = 4326) %>%
  
  # Transform to a different CRS (Coordinate Reference System)
  st_transform(crs = 32647)
```

```{r}
#| eval: false
write_rds(car_acc,"data/acc.rds")

```

```{r}
acc <- read_rds("data/acc.rds")
```
